(function(A){A.fn.wpPreroll=function(D){var F=A.extend({callback:null,primary:"flash",type:"video",adZone:"auto",jwplayerDir:"http://www.washingtonpost.com/rw/sites/twpweb/js/multimedia/jwplayer/v6/",showCompanion:"auto",companionMargin:15,companionHeight:250,companionWidth:300,fullHeight:this.outerHeight(),fullWidth:this.outerWidth(),videoWidth:this.outerWidth(),adBlockTime:30,containerCSS:{"position":"absolute","overflow":"hidden","color":"#FFF","font-size":"14px","font-weight":"bold","text-align":"left"}},D);var B=function(){var b="";var P=(new Date()).valueOf();if(F.adZone=="auto"){switch(F.type){case"gallery":b="http://ad.doubleclick.net/pfadx/wpni.video.oogallery;frmt=2;frmt=1;frmt=0;vid=15;vid=30;sz=640x480;tp_video=null;dmct=text/html;ord="+P+";";break;case"games":b="http://ad.doubleclick.net/pfadx/wpni.video.oogames;frmt=2;frmt=1;frmt=0;vid=15;vid=30;sz=640x480;tp_video=null;dmct=text/html;ord="+P+";";break;case"comics":b="http://ad.doubleclick.net/pfadx/wpni.video.jwcomics;frmt=2;frmt=1;frmt=0;vid=15;vid=30;sz=640x480;ord="+P+";";break;case"weather":b="http://ad.doubleclick.net/N701/pfadx/wpni.video.weather;frmt=2;frmt=1;frmt=0;vid=15;vid=30;sz=640x480;ord="+P+";";break;default:b="http://ad.doubleclick.net/pfadx/wpni.video.oogen;frmt=2;frmt=1;frmt=0;vid=15;vid=30;sz=640x480;tp_video=null;dmct=text/html;ord="+P+";";break;}}else{b="http://ad.doubleclick.net/pfadx/"+F.adZone+";frmt=2;frmt=1;frmt=0;vid=15;vid=30;sz=640x480;tp_video=null;dmct=text/html;ord="+P+";";}var J=A('<div class="video-ad-box"></div>');var U=Math.floor(Math.random()*10000000);var Q=A('<div class="jw-player" id="jw-player-'+U+'"></div>');var K="jw-companion-ad-"+U;var X=A('<div class="jw-companion-ad" id="'+K+'"></div>');var Z={};var R=0;var L=false,W=false;J.append(Q);F.showCompanion=F.showCompanion=="auto"?(F.fullWidth>700):F.showCompanion;if(F.showCompanion){J.append(X);F.videoWidth=F.fullWidth-F.companionWidth-F.companionMargin;X.css({"position":"absolute","top":(F.fullHeight-F.companionHeight)/2+"px","right":0,"width":F.companionWidth+"px","height":F.companionHeight+"px"});Z={client:"googima",tag:b,companiondiv:{id:K,width:F.companionWidth,height:F.companionHeight}};}else{Z={client:"googima",tag:b};}if(this.height()<=250){F.containerCSS=A.extend({"background":"#000 url(http://www.washingtonpost.com/wp-srv/projects/supergrid/img/loading-black-100x100.gif) no-repeat center top 100px"},F.containerCSS);}else{F.containerCSS=A.extend({"background":"#000 url(http://www.washingtonpost.com/wp-srv/projects/supergrid/img/loading-black-100x100.gif) no-repeat center center"},F.containerCSS);}if(this.css("position")=="relative"||this.css("position")=="absolute"){J.css(A.extend({"top":0,"left":0,"width":F.fullWidth+"px","height":F.fullHeight+"px"},F.containerCSS));this.append(J);}else{var O=this.offset();J.css(A.extend({"top":O.top,"left":O.left,"width":F.fullWidth+"px","height":F.fullHeight+"px"},F.containerCSS));A("body").append(J);}var V=function(c){if(window.s){var d={};d.eVar13=F.type+" pre-roll";d.eVar49=F.type;if(s.eVar1.length==0){d.eVar1=d.eVar2=d.eVar17="embed";}if(R!=0){d.eVar48=R;}switch(c){case"final":s.sendDataToOmniture("Video Ad Complete","event8",d);break;case"start":s.sendDataToOmniture("Video Ad Start","event7",d);break;case"prepare":s.sendDataToOmniture("Video Ad Prepare","event30",d);break;}}};var M=function(){jwplayer(Q[0]).stop();J.remove();if(F.callback!=null&&typeof (F.callback)=="function"){F.callback();}};var T=function(){jwplayer(Q[0]).stop();var c=10;J.empty().html('<div style="padding: 20px; text-align: center;">Sorry, we\'re unable to load a message from our sponsors.<br /><br /> To display this message you need to install Shockwave Flash Plugin to your browser. <br /><br />Your content will resume in <span class="wp-adblock-counter">'+c+"</span> seconds.</div>");var d=J.find(".wp-adblock-counter");var e=function(){c--;if(c<=0){M();}else{d.html(""+c+"");setTimeout(e,1000);}};setTimeout(e,1000);};var a=function(){jwplayer.key="ki3+KclbG9mBpkeFlZarUFKpC5JDsKHoUUZA4Q==";jwplayer.utils.log=function(i,e){if(typeof console!="undefined"&&typeof console.log!="undefined"){if(e){console.log(i,e);}else{console.log(i);}}if(i=="No suitable players found"){A(".video-ad-box").remove();if(F.callback!=null&&typeof (F.callback)=="function"){F.callback();}}};var c=false;try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){c=true;}}catch(h){for(var f=0;f<window.navigator.plugins.length&&!c;f++){var g=window.navigator.plugins[f];for(var d=0;d<g.length;d++){if(g[d].type!=undefined&&g[d].type.indexOf("application/x-shockwave-flash")>-1){F.primary="flash";c=true;break;}}}}if(!c){F.primary="html5";}if(window.navigator.userAgent.indexOf("Firefox")>0&&!c){T();}else{jwplayer(Q[0]).setup({primary:F.primary,fallback:true,advertising:Z,file:F.jwplayerDir+"prerollVideo.m4v",height:F.fullHeight,width:F.videoWidth,controls:false,autostart:true,events:{onReady:function(){try{V("prepare");}catch(i){}},onTime:function(i){try{if(L){if(!W){R=Math.round(i.duration);W=true;}}}catch(j){}},onBeforePlay:function(){try{if(L){M();V("final");}else{L=true;V("start");}}catch(i){}},onComplete:function(){try{M();}catch(i){}}}});}};if(typeof jwplayer=="undefined"){var Y=document.createElement("script");Y.type="text/javascript";Y.src=F.jwplayerDir+"jwplayer.js";document.getElementsByTagName("head")[0].appendChild(Y);function S(){if(typeof jwplayer!="undefined"){clearInterval(N);a();}}var N=setInterval(S,200);}else{a();}};var G=0;var H="adsFlag=";var C=document.cookie.split(";");for(var E=0;E<C.length;E++){var I=C[E];while(I.charAt(0)==" "){I=I.substring(1,I.length);}if(I.indexOf(H)==0){G=I.substring(H.length,I.length);break;}}if((G==0)&&!(navigator.platform=="iPad"||navigator.platform=="iPod"||navigator.platform=="iPhone")){B.call(this);}else{if(F.callback!=null&&typeof (F.callback)=="function"){F.callback();}}return this;};})(jQuery);